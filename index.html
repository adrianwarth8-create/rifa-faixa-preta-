<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Rifa Faixa Preta ‚Äì Adrian Warth</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <style>
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(135deg, #0a1a2a, #001f3f);
      color: #fff;
      text-align: center;
    }

    h1 { margin-top: 20px; }
    h2 { margin-bottom: 10px; }

    .contador {
      font-size: 18px;
      margin: 10px 0 20px;
      color: #ffcc00;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
      gap: 10px;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }

    .numero {
      background: #123;
      padding: 15px 0;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.2s;
    }

    .numero:hover {
      background: #1e90ff;
    }

    .vendido {
      background: #8b0000 !important;
      cursor: not-allowed;
    }

    .form {
      background: rgba(0,0,0,0.5);
      padding: 20px;
      max-width: 400px;
      margin: 30px auto;
      border-radius: 10px;
    }

    input, button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 6px;
      border: none;
      font-size: 16px;
    }

    button {
      background: #c62828;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover {
      background: #ff0000;
    }

    footer {
      margin: 20px;
      font-size: 14px;
      opacity: 0.8;
    }
  </style>
</head>

<body>

<h1>üéüÔ∏è Rifa Solid√°ria</h1>
<h2>Faixa Preta ‚Äì Taekwondo</h2>

<div class="contador" id="contador"></div>

<p>Valor: <strong>R$ 5,00</strong> por n√∫mero</p>

<div class="grid" id="grid"></div>

<div class="form">
  <h3>Reservar n√∫mero</h3>
  <input type="text" id="nome" placeholder="Nome completo" />
  <input type="text" id="whats" placeholder="WhatsApp (DDD + n√∫mero)" />
  <input type="text" id="numeroSelecionado" placeholder="N√∫mero escolhido" readonly />
  <button onclick="reservar()">Reservar n√∫mero</button>
</div>

<footer>
  Sorteio: <strong>25 de agosto √†s 10h</strong> ‚Äì Instagram<br>
  D√∫vidas: WhatsApp 55999929198
</footer>

<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzI26GdLBO17EX5jB2q1faSmuq3u1NePst2lzvfAykMHEViyd8VpnwTovUtlantk6vtLw/exec";
  const TOTAL = 1000;
  let vendidos = [];

  function formatar(n) {
    return n.toString().padStart(3, "0");
  }

  function criarGrid() {
    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    for (let i = 1; i <= TOTAL; i++) {
      const num = formatar(i);
      const div = document.createElement("div");
      div.className = "numero";
      div.innerText = num;

      if (vendidos.includes(num)) {
        div.classList.add("vendido");
      } else {
        div.onclick = () => {
          document.getElementById("numeroSelecionado").value = num;
        };
      }

      grid.appendChild(div);
    }
  }

  function carregarVendidos() {
    fetch(SCRIPT_URL)
      .then(res => res.json())
      .then(data => {
        vendidos = data;
        criarGrid();
      })
      .catch(() => alert("Erro ao carregar n√∫meros"));
  }

  function reservar() {
    const nome = document.getElementById("nome").value.trim();
    const whats = document.getElementById("whats").value.trim();
    const numero = document.getElementById("numeroSelecionado").value;

    if (!nome || !whats || !numero) {
      alert("Preencha todos os campos");
      return;
    }

    fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify({ nome, whats, numero })
    })
    .then(res => res.json())
    .then(resp => {
      if (resp.status === "ok") {
        window.open(
          `https://wa.me/55${whats}?text=Ol√°! Reservei o n√∫mero ${numero} da rifa da Faixa Preta.`,
          "_blank"
        );
        alert("N√∫mero reservado com sucesso!");
        carregarVendidos();
      } else {
        alert(resp.mensagem || "Erro ao reservar");
      }
    })
    .catch(() => alert("Erro ao reservar. Tente novamente."));
  }

  function contador() {
    const fim = new Date("2026-08-25T10:00:00");
    const agora = new Date();
    const diff = fim - agora;

    if (diff <= 0) {
      document.getElementById("contador").innerText = "Sorteio em andamento!";
      return;
    }

    const d = Math.floor(diff / (1000 * 60 * 60 * 24));
    const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const m = Math.floor((diff / (1000 * 60)) % 60);

    document.getElementById("contador").innerText =
      `‚è≥ Faltam ${d} dias, ${h}h ${m}min para o sorteio`;
  }

  carregarVendidos();
  contador();
  setInterval(contador, 60000);
</script>

</body>
</html>
